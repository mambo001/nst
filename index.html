<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ey</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
  </head>
<body>
    <div id="map"></div> 

    <div class="sidebar">
      <div class="card sidebar-item">
        <div class="card-content">
          <span class="card-title">Destination</span>
          <p>Enter your starting point and destination</p>

          <div class="input-field">
            <input placeholder="Catarman" id="inputStartingPoint" type="text" class="validate">
            <label class="active" for="inputStartingPoint">Starting Point</label>
          </div>

          <div class="input-field">
            <input placeholder="Mars" id="inputDestination" type="text" class="validate">
            <label class="active" for="inputDestination">Destination</label>
          </div>
          
        </div>
        <div class="card-action">
          <button class="btn waves-effect waves-light" id="buttonSearch">Search
            <i class="material-icons right">search</i>
          </button>
        </div>
      </div>
    </div>
      <script>
        var map,
            search,
            infoWindow,
            defaultBounds,
            inputStartingPoint = document.querySelector('#inputStartingPoint'),
            inputDestination = document.querySelector('#inputDestination'),
            buttonSearch = document.querySelector('#buttonSearch');
        function initMap() {
          map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 12.379054, lng: 124.820326},
            zoom: 11,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            disableDefaultUI: true
          });

          // defaultBounds = ;
          inputStartingPoint = new google.maps.places.SearchBox(inputStartingPoint, {
            types: ['geocode'],
            // types: {regions: 'administrative_area_level_3'},
            // bounds: defaultBounds,
            componentRestrictions: {country: 'ph'}
          });

          inputDestination = new google.maps.places.SearchBox((inputDestination));

          // get location after clicking search
          // get latlng of location
          // add marker to each location
          // get destination? destination? streep view? directions?
          // get destination's ETA
          // get destinations accomodations? suggestions?
          buttonSearch.addEventListener('click', (e) => {
            let places = [],
              startingPoint = inputStartingPoint.getPlaces(),
              destinationPoint = inputDestination.getPlaces();

            places.push(startingPoint[0]);
            places.push(destinationPoint[0]);

            console.log(places);
          });



          map.addListener('bounds_changed', function() {
            inputStartingPoint.setBounds(map.getBounds());
          });

          inputStartingPoint.addListener('place_changed', function() {

            var place = inputStartingPoint.getPlace();

            if (place.length == 0) {
                return;
            }

            if (!place.geometry) {
                console.log("No details available for input: '" + place.name + "'");
                return;
            }

            // ...

          });

          infoWindow = new google.maps.InfoWindow;

          // Try HTML5 geolocation.
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
              var pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
              };

              infoWindow.setPosition(pos);
              infoWindow.setContent('Location found.');
              infoWindow.open(map);
              map.setCenter(pos);
              inputStartingPoint.setBounds(pos);
              
            }, function() {
              handleLocationError(true, infoWindow, map.getCenter());
              
            });
          } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, infoWindow, map.getCenter());
          }



         }


        
        
      </script>
      <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPBDWelc9YGjZpJJQBL5-Qc0D7OHwN7II&libraries=places&callback=initMap"
      async defer></script>
        <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

</body>
</html>